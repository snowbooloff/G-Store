import{d as A,o as r,a as y,j as m,e as t,t as d,u as l,Q as P,f as S,Y as F,M as G,Z as D,_ as V,h as C,y as B,V as R,q as E,g as h,P as I,G as g,J as f,c as $,w as T,b as k,l as M,p as O,m as j,X as z}from"./vendor-8bbb4221.js";import{a as U,b as q,I as J}from"./index-24cb0f64.js";import{_ as N}from"./_plugin-vue_export-helper-c27b6911.js";import{N as Q}from"./NavBarForEmpty-1967f09a.js";import{f as X}from"./fetchGameDetails-d297a9da.js";import{l as v}from"./index-770713f3.js";const Y={class:"shopping-item flex"},Z={class:"shopping-pannel flex"},H={class:"shopping-details flex flex_column"},K={class:"shopping-details__price main-blue"},W=A({__name:"ShoppingItem",props:{game:null},setup(s){const{removeGame:n}=P("shoppingRemove");return(o,p)=>{const e=S("v-lazy-image"),c=S("icon-cross");return r(),y("article",Y,[m(e,{class:"shopping-item_img",imgSrc:s.game.background_image,alt:s.game.name},null,8,["imgSrc","alt"]),t("div",Z,[t("div",H,[m(U,{class:"shopping-details__title",gameId:s.game.id,gameName:s.game.name},null,8,["gameId","gameName"]),m(q,{class:"shopping-details__platforms",platforms:s.game.parent_platforms},null,8,["platforms"]),t("h3",K,d(s.game.suggestions_count==0?"Free":"$"+s.game.suggestions_count/10),1)]),t("button",{class:"shopping-pannel__bttn cursor-pointer",onClick:p[0]||(p[0]=x=>l(n)(s.game))},[m(c,{class:"shopping-pannel__icon"})])])])}}});const ee=N(W,[["__scopeId","data-v-d545e004"]]);function te(s){const n=F(G());D(V(n,"Promo")).then(o=>{if(o.exists()){const e=o.val().find(c=>c.value===s.value);s.isChecked=!0,e?(s.isActive=!0,s.discount=e.discount,s.discountType=e.discountType):s.isActive=!1}else console.log("No data available")}).catch(o=>{console.error(o)})}const u=s=>(O("data-v-a8819f03"),s=s(),j(),s),se={class:"page-block flex flex_column"},oe={class:"page-block__title main-white"},ie={class:"shopping-block flex"},ae={key:2,class:"order-info"},ne={class:"order-info__block flex flex_align-center"},ce=u(()=>t("h3",{class:"order-info__title main-white"},"Subtotal:",-1)),le={class:"order-info__price main-blue"},_e={class:"order-info__block flex flex_align-center"},de=u(()=>t("h3",{class:"order-info__title main-white"},"Sales Tax:",-1)),me={class:"order-info__price main-blue"},pe={class:"order-info__block flex flex_align-center"},re=u(()=>t("h3",{class:"order-info__title main-white"},"Grand Total:",-1)),ue={class:"order-info__price main-blue"},he={class:"promo flex flex_column"},ge=u(()=>t("h3",{class:"promo__title main-white"},"Redeem Promo Code:",-1)),fe={class:"promo__status promo__status_red"},ve={class:"promo__status promo__status_green"},xe=u(()=>t("button",{class:"order-info__bttn bttn bttn_buy"},"Checkout",-1)),be=A({__name:"ShoppingView",setup(s){const n=M(),o=C([]);B(()=>{const i=v.getList(v.shopping);i.length&&(n.commit("loading/setLoading",!0),i.forEach(a=>{const _=C([]);X(_,a).then(()=>{o.value.push(_.value)}).then(()=>{a==i[i.length-1]&&n.commit("loading/setLoading",!1)})}))}),z("shoppingRemove",{removeGame:p});function p(i){const a=o.value.indexOf(i);o.value.splice(a,1),v.placeItem(v.shopping,i.id),n.commit("notification/pushNotification",`${i.name}: removed from shopping cart`)}const e=R({isActive:!1,isChecked:!1,value:"",discount:0,discountType:""});E(e,()=>{e.value.length||(e.isChecked=!1,e.isActive=!1)});const c=h(()=>{let i=o.value.reduce((a,_)=>a+=_.suggestions_count/10,0);return e.discountType=="%"&&e.isActive?i=i-i/100*e.discount:e.discountType=="$"&&e.isActive&&(i=i-e.discount),i.toFixed(2)}),x=h(()=>(+c.value/79).toFixed(2)),L=h(()=>(+x.value+ +c.value).toFixed(2)),w=h(()=>n.state.loading.isLoading);return(i,a)=>{const _=S("v-input-submit");return r(),y("section",se,[t("h1",oe,[I(" Shopping Cart "),g(t("span",{class:"page-block__count main-blue"},"("+d(o.value.length)+" items)",513),[[f,o.value.length]])]),t("div",ie,[!l(w)&&o.value.length?(r(),$(J,{key:0,class:"shopping-block__content game-list",itemsList:o.value},{item:T(b=>[m(ee,{game:b.item},null,8,["game"])]),_:1},8,["itemsList"])):k("",!0),!l(w)&&!o.value.length?(r(),$(Q,{key:1},{default:T(()=>[I(" Shopping list is empty ")]),_:1})):k("",!0),o.value.length?(r(),y("div",ae,[t("div",ne,[ce,t("p",le,"$"+d(l(c)),1),g(t("p",{class:"order-info__discount main-white"},d("-"+e.discountType+e.discount),513),[[f,e.isActive]])]),t("div",_e,[de,t("p",me,"$"+d(l(x)),1)]),t("div",pe,[re,t("p",ue,"$"+d(l(L)),1)]),t("div",he,[ge,m(_,{class:"promo__input",modelValue:e.value,"onUpdate:modelValue":a[0]||(a[0]=b=>e.value=b),maxlength:"15",placeholder:"PROMO1",submitFunc:l(te),funcArguments:e},null,8,["modelValue","submitFunc","funcArguments"]),g(t("span",fe,"Invalid promo",512),[[f,e.isChecked&&!e.isActive]]),g(t("span",ve,"Promo activated",512),[[f,e.isChecked&&e.isActive]])]),xe])):k("",!0)])])}}});const $e=N(be,[["__scopeId","data-v-a8819f03"]]);export{$e as default};
